---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/PostCard.astro';
import { getCollection } from 'astro:content';

const recentPosts = (await getCollection('blog', ({ data }) => !data.draft))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);

const navCards = [
  {
    href: '/about',
    label: 'About',
    description: 'Who I am and why any of this exists.',
  },
  {
    href: '/blog',
    label: 'Blog',
    description: 'Game design takes. Fantasy sports. Whatever.',
  },
  {
    href: '/now',
    label: 'Now',
    description: 'What I\'m currently playing, watching, obsessing over.',
  },
  {
    href: '/contact',
    label: 'Contact',
    description: 'Say something. I don\'t bite.',
  },
];
---

<BaseLayout title="Home">
  <!-- Hero -->
  <section class="mb-16">
    <p
      class="text-sm font-medium mb-3 tracking-widest uppercase"
      style="color: var(--color-accent);"
    >
      Hey, I'm
    </p>
    <h1
      class="text-5xl font-bold mb-5"
      style="font-family: var(--font-display); color: var(--color-heading);"
    >
      Ben Atkins
    </h1>
    <p class="text-xl leading-relaxed mb-4" style="color: var(--color-body);">
      IT Support &amp; SysAdmin by day. Thinker about game design, fantasy sports
      obsessive, and occasional writer by night.
    </p>
    <p style="color: var(--color-muted);">
      This isn't a portfolio. It's just a place to write things down.
    </p>
  </section>

  <!-- Nav cards -->
  <section class="mb-16 grid grid-cols-2 gap-3 sm:grid-cols-2">
    {navCards.map(card => (
      <a
        href={card.href}
        class="group block border border-[#2a2a2a] rounded-lg p-4 hover:border-[#7c3aed] hover:bg-[#1a1a1a] transition-colors duration-200"
      >
        <span
          class="block text-sm font-semibold mb-1 group-hover:text-[#a78bfa] transition-colors duration-200"
          style="font-family: var(--font-display); color: var(--color-heading);"
        >
          {card.label} →
        </span>
        <span class="block text-xs" style="color: var(--color-muted);">
          {card.description}
        </span>
      </a>
    ))}
  </section>

  <!-- Recent posts -->
  {recentPosts.length > 0 && (
    <section>
      <h2
        class="text-xs font-medium uppercase tracking-widest mb-5"
        style="color: var(--color-muted);"
      >
        Recent Posts
      </h2>
      <div class="flex flex-col gap-4">
        {recentPosts.map(post => (
          <PostCard
            title={post.data.title}
            description={post.data.description}
            pubDate={post.data.pubDate}
            slug={post.slug}
            tags={post.data.tags}
          />
        ))}
      </div>
      <a
        href="/blog"
        class="inline-block mt-6 text-sm transition-colors duration-200"
        style="color: var(--color-accent);"
        onmouseover="this.style.color='var(--color-accent-light)'"
        onmouseout="this.style.color='var(--color-accent)'"
      >
        All posts →
      </a>
    </section>
  )}
</BaseLayout>
